<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AetherSwap | Next-Gen Privacy DEX</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@solana/web3.js@latest"></script>
  <style>
    .language-selector {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 50;
      opacity: 0.7;
      transition: opacity 0.2s;
    }
    .language-selector:hover {
      opacity: 1;
    }
    .language-selector select {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
  </style>
</head>
<body class="min-h-screen bg-gray-900 text-white">
  <!-- Language Selector (Fixed Top-Right) -->
  <div class="language-selector">
    <select id="language-select" class="px-3 py-1 rounded-lg text-sm focus:outline-none">
      <option value="en">ğŸ‡¬ğŸ‡§ English</option>
      <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
      <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
      <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
      <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
      <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
    </select>
  </div>

  <!-- Main Content -->
  <div class="container mx-auto p-4 max-w-md pt-16">
    <!-- Logo + Title -->
    <div class="flex flex-col items-center mb-8">
      <img src="your-logo.png" alt="AetherSwap Logo" class="w-20 h-20 mb-4">
      <h1 class="text-3xl font-bold">AetherSwap</h1>
      <p class="text-gray-400">by [YourName]</p>
    </div>

    <!-- Token Search & Selection -->
    <div class="mb-6">
      <div class="flex justify-between items-center mb-2">
        <h2 class="font-semibold">Select Token</h2>
        <button id="custom-token-btn" class="text-xs text-purple-400 hover:text-purple-300">
          + Add Custom Token
        </button>
      </div>
      
      <!-- Token Search -->
      <input type="text" id="token-search" placeholder="Search by name or contract address" 
             class="w-full bg-gray-700 p-3 rounded-lg mb-3 text-sm">
      
      <!-- Token List -->
      <div class="max-h-60 overflow-y-auto bg-gray-800 rounded-lg">
        <div id="token-list" class="divide-y divide-gray-700">
          <!-- Preloaded tokens will appear here -->
        </div>
      </div>
    </div>

    <!-- Swap Interface -->
    <div class="bg-gray-800 rounded-xl p-6 shadow-2xl">
      <!-- ... (rest of your swap interface) ... -->
    </div>
  </div>

  <script>
    // Preloaded Tokens (Solana Mainnet)
    const PRELOADED_TOKENS = [
      {
        symbol: "SOL",
        name: "Solana",
        mint: "So11111111111111111111111111111111111111112",
        decimals: 9,
        logo: "solana-logo.png"
      },
      {
        symbol: "USDC",
        name: "USD Coin",
        mint: "EPjFWdd5AufqSSqeM2q6DQNpMQNcFcSq2GmKkExN6TfK",
        decimals: 6,
        logo: "usdc-logo.png"
      },
      {
        symbol: "USDT",
        name: "Tether USD",
        mint: "Es9vMFrzaCERmJfrE4H2FYD1KZbYUsMrhPkMk81A7xKZ",
        decimals: 6,
        logo: "usdt-logo.png"
      },
      {
        symbol: "RAY",
        name: "Raydium",
        mint: "4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R",
        decimals: 6,
        logo: "raydium-logo.png"
      }
    ];

    // Language Support
    const TRANSLATIONS = {
      en: {
        select_token: "Select Token",
        add_custom: "+ Add Custom Token",
        search_placeholder: "Search by name or contract address",
        // ... other translations
      },
      fr: {
        select_token: "SÃ©lectionner un Token",
        add_custom: "+ Ajouter un Token",
        search_placeholder: "Rechercher par nom ou adresse de contrat",
        // ... other translations
      },
      // ... other languages
    };

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Load tokens
      renderTokenList(PRELOADED_TOKENS);
      
      // Language selector
      document.getElementById('language-select').addEventListener('change', (e) => {
        updateLanguage(e.target.value);
      });
      
      // Token search
      document.getElementById('token-search').addEventListener('input', (e) => {
        searchTokens(e.target.value);
      });
      
      // Custom token button
      document.getElementById('custom-token-btn').addEventListener('click', () => {
        addCustomToken();
      });
    });

    function renderTokenList(tokens) {
      const container = document.getElementById('token-list');
      container.innerHTML = tokens.map(token => `
        <div class="token-item p-3 hover:bg-gray-700 cursor-pointer flex items-center" 
             data-mint="${token.mint}">
          <img src="${token.logo}" class="w-6 h-6 mr-3 rounded-full">
          <div>
            <div class="font-medium">${token.symbol}</div>
            <div class="text-xs text-gray-400">${token.name}</div>
          </div>
        </div>
      `).join('');
      
      // Add click handlers
      document.querySelectorAll('.token-item').forEach(item => {
        item.addEventListener('click', () => {
          selectToken(item.dataset.mint);
        });
      });
    }

    function searchTokens(query) {
      const filtered = PRELOADED_TOKENS.filter(token => 
        token.symbol.toLowerCase().includes(query.toLowerCase()) || 
        token.name.toLowerCase().includes(query.toLowerCase()) ||
        token.mint.toLowerCase().includes(query.toLowerCase())
      );
      renderTokenList(filtered);
    }

    function addCustomToken() {
      const address = prompt("Enter token contract address:");
      if (address && address.length > 0) {
        // Validate and add token
        console.log("Adding custom token:", address);
        // In a real app, you would validate the address and fetch token info
      }
    }

    function updateLanguage(lang) {
      document.documentElement.lang = lang;
      const t = TRANSLATIONS[lang] || TRANSLATIONS.en;
      
      document.getElementById('token-search').placeholder = t.search_placeholder;
      document.getElementById('custom-token-btn').textContent = t.add_custom;
      // Update other elements...
    }
  </script>
  // Connexion au wallet Phantom ou Backpack
async function connectWallet() {
  if (window.solana && window.solana.isPhantom) {
    try {
      const resp = await window.solana.connect();
      console.log("âœ… Wallet connectÃ© :", resp.publicKey.toString());
      alert("Wallet connectÃ© : " + resp.publicKey.toString());
    } catch (err) {
      console.error("âŒ Connexion annulÃ©e :", err);
    }
  } else {
    alert("Phantom ou Backpack Wallet non dÃ©tectÃ© !");
  }
}

// Bouton de connexion Ã  afficher dans le HTML
const walletBtn = document.createElement("button");
walletBtn.textContent = "ğŸ” Connect Wallet";
walletBtn.className = "mb-6 px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-sm";
walletBtn.onclick = connectWallet;
document.querySelector(".container").prepend(walletBtn);

// Ajout dâ€™un token personnalisÃ© avec validation
async function addCustomToken() {
  const mintAddress = prompt("Entrez lâ€™adresse du token (mint) :");

  if (!mintAddress || mintAddress.length < 32) {
    alert("Adresse invalide.");
    return;
  }

  try {
    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl("mainnet-beta"));
    const mintPubkey = new solanaWeb3.PublicKey(mintAddress);

    const accountInfo = await connection.getParsedAccountInfo(mintPubkey);

    if (!accountInfo.value) {
      alert("âŒ Token non trouvÃ© sur la blockchain.");
      return;
    }

    // VÃ©rifie si c'est un token SPL valide
    const parsed = accountInfo.value.data;
    if (parsed?.program !== "spl-token") {
      alert("âŒ Ce nâ€™est pas un token SPL valide.");
      return;
    }

    const decimals = parsed.parsed.info.decimals || 0;
    const symbol = prompt("Nom du token (ex: XYZ) :") || "CUSTOM";
    const name = prompt("Nom complet du token :") || "Custom Token";
    const logo = prompt("Lien vers un logo (URL) :") || "token-placeholder.png";

    const newToken = {
      symbol,
      name,
      mint: mintAddress,
      decimals,
      logo
    };

    PRELOADED_TOKENS.push(newToken);
    renderTokenList(PRELOADED_TOKENS);
    alert(`âœ… Token ${symbol} ajoutÃ© !`);
  } catch (err) {
    console.error("Erreur lors de l'ajout du token :", err);
    alert("âŒ Erreur : token invalide ou rÃ©seau indisponible.");
  }
}
</body>
</html>