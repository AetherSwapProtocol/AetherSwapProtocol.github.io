<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AetherSwap - Decentralized Exchange</title>
  <!-- TailwindCSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- Solana Web3.js -->
  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js" defer></script>
  <!-- Jupiter Aggregator SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@jup-ag/core" defer></script>
  <style>
    body {
      font-family: 'Space Grotesk', sans-serif;
      background-color: #0a0a0a;
      color: #ffffff;
      transition: background-color 0.3s, color 0.3s;
    }
    body.light-mode {
      background-color: #ffffff;
      color: #000000;
    }
    .gradient-border {
      position: relative;
      display: inline-block;
      padding: 1px;
      border-radius: 1rem;
      background: linear-gradient(45deg, #7e22ce, #3b82f6, #7e22ce);
      background-size: 200% 200%;
      animation: gradient 3s ease infinite;
    }
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .token-suggestions {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #374151;
      border-radius: 0.5rem;
      background-color: #111827;
    }
    .token-item:hover {
      background-color: #374151;
    }
    .swap-icon {
      transition: transform 0.3s ease;
    }
    .swap-icon:hover {
      transform: rotate(180deg);
    }
  </style>
</head>
<body class="dark-mode">

<!-- HEADER -->
<header class="flex justify-between items-center p-6 bg-[#1A1A40] shadow-lg">
  <img src="logo-dex.png" alt="DEX Logo" class="h-10">
  <nav class="flex space-x-6 text-sm">
    <a href="#" class="hover:text-cyan-400">Swap</a>
    <a href="#" class="hover:text-cyan-400">Liquidity</a>
    <a href="#" class="hover:text-cyan-400">Portfolio</a>
    <a href="#" class="hover:text-cyan-400">Settings</a>
  </nav>
  <button id="toggle-mode" class="px-4 py-2 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg font-medium">
    Toggle Mode
  </button>
</header>

<!-- MAIN SWAP CONTAINER -->
<main class="max-w-lg mx-auto mt-10 p-8 bg-[#111827] rounded-lg shadow-lg">
  <h1 class="text-2xl font-bold mb-6 text-center">Token Swap</h1>
  
  <!-- Wallet Info -->
  <div id="wallet-info" class="p-4 mb-6 bg-gray-800 rounded-lg text-white">
    <p id="wallet-address">Wallet: Not connected</p>
    <p id="wallet-balance">Balance: -</p>
    <button onclick="connectWallet()" class="px-4 py-2 bg-blue-500 text-white rounded-lg">Connect Wallet</button>
  </div>

  <!-- From Section -->
  <div class="mb-4">
    <div class="flex justify-between items-center mb-2">
      <label class="block text-sm font-medium">From:</label>
      <span id="from-balance" class="text-xs text-gray-400">Balance: -</span>
    </div>
    <div class="flex items-center space-x-2">
      <div class="relative flex-1">
        <input id="from-token" type="text" placeholder="SOL, USDC, etc..." 
               class="bg-gray-800 text-white p-3 rounded-lg w-full">
        <div id="from-suggestions" class="token-suggestions hidden absolute z-10 w-full mt-1"></div>
      </div>
      <input id="from-amount" type="number" placeholder="0.0" 
             class="bg-gray-800 text-white p-3 rounded-lg flex-1">
    </div>
  </div>

  <!-- Swap Direction Toggle -->
  <div class="flex justify-center my-2">
    <button id="swap-direction" class="swap-icon p-2 bg-gray-700 rounded-full">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v3.586L7.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7z" clip-rule="evenodd" />
      </svg>
    </button>
  </div>

  <!-- To Section -->
  <div class="mb-6">
    <div class="flex justify-between items-center mb-2">
      <label class="block text-sm font-medium">To:</label>
      <span id="to-balance" class="text-xs text-gray-400">Balance: -</span>
    </div>
    <div class="relative">
      <input id="to-token" type="text" placeholder="SOL, USDC, etc..." 
             class="bg-gray-800 text-white p-3 rounded-lg w-full">
      <div id="to-suggestions" class="token-suggestions hidden absolute z-10 w-full mt-1"></div>
    </div>
  </div>

  <!-- Advanced Options -->
  <div class="mb-6 border-t border-gray-700 pt-4">
    <div class="flex justify-between items-center mb-2">
      <label class="block text-sm font-medium">Slippage Tolerance:</label>
      <div class="flex space-x-2">
        <button class="slippage-option px-2 py-1 text-xs rounded" value="0.5">0.5%</button>
        <button class="slippage-option px-2 py-1 text-xs rounded" value="1.0">1.0%</button>
        <button class="slippage-option px-2 py-1 text-xs rounded" value="2.0">2.0%</button>
        <input type="number" id="custom-slippage" placeholder="Custom" 
               class="w-16 bg-gray-800 text-white px-2 py-1 text-xs rounded">
      </div>
    </div>
  </div>

  <!-- Swap Info -->
  <div class="text-sm text-gray-400 mb-6 space-y-1">
    <div class="flex justify-between">
      <span>Exchange Rate:</span>
      <span id="rate-info">-</span>
    </div>
    <div class="flex justify-between">
      <span>Minimum Received:</span>
      <span id="min-received">-</span>
    </div>
    <div class="flex justify-between">
      <span>Price Impact:</span>
      <span id="price-impact">-</span>
    </div>
  </div>

  <!-- Swap Button -->
  <button onclick="fetchSwapRoutes()" class="px-4 py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg w-full">
    Execute Swap
  </button>
</main>

<!-- FOOTER -->
<footer class="text-center mt-10 text-sm text-gray-400">
  <p>Â© 2025 AetherSwap Protocol. All rights reserved.</p>
</footer>

<!-- SCRIPTS -->
<script>
  let state = {
    wallet: null,
    tokens: [],
    fromToken: null,
    toToken: null,
    slippage: 0.5
  };

  async function connectWallet() {
    const provider = window.phantom?.solana;
    if (!provider) {
      alert('Phantom Wallet not found. Please install it.');
      return;
    }
    try {
      const response = await provider.connect();
      const publicKey = response.publicKey.toString();
      document.getElementById('wallet-address').textContent = `Wallet: ${publicKey}`;
      fetchBalance(publicKey);
    } catch (error) {
      console.error('Error connecting wallet:', error);
    }
  }

  async function fetchBalance(publicKey) {
    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'));
    const balance = await connection.getBalance(new solanaWeb3.PublicKey(publicKey));
    document.getElementById('wallet-balance').textContent = `Balance: ${(balance / solanaWeb3.LAMPORTS_PER_SOL).toFixed(2)} SOL`;
  }

  async function fetchSwapRoutes() {
    const inputMint = 'So11111111111111111111111111111111111111112'; // Example SOL Mint Address
    const outputMint = 'AETH111111111111111111111111111111111111111'; // Example AETH Mint Address
    const amount = parseFloat(document.getElementById('from-amount').value) * Math.pow(10, 9); // Amount in lamports

    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'));
    const jupiter = await JupiterCore.init({ connection });
    const routes = await jupiter.getRoutes({
      inputMint,
      outputMint,
      amount,
      slippage: state.slippage
    });

    if (routes.length > 0) {
      executeSwap(routes[0]);
    } else {
      alert('No routes available for this swap.');
    }
  }

  async function executeSwap(route) {
    const provider = window.phantom?.solana;
    const wallet = await provider.connect();
    const { transaction } = await JupiterCore.prepareTransaction({
      route,
      wallet
    });

    const signedTransaction = await wallet.signTransaction(transaction);
    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'));
    const txId = await connection.sendRawTransaction(signedTransaction.serialize());
    alert(`Swap executed! Transaction ID: ${txId}`);
  }
</script>
</body>
</html>