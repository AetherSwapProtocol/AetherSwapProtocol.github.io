<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AetherSwap | Next-Gen DEX Aggregator</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
  <script src="https://unpkg.com/@solana/web3.js@1.70.1/lib/index.iife.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://s3.tradingview.com/tv.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .gradient-bg {
      background: linear-gradient(135deg, #7e22ce 0%, #3b82f6 100%);
    }
    .tradingview-widget-container iframe {
      border-radius: 12px !important;
    }
  </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
  <!-- Language Selector -->
  <div class="fixed top-4 right-4 z-50">
    <select id="languageSelector" class="bg-gray-800 text-sm rounded-full px-3 py-1 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500">
      <option value="en">English</option>
      <option value="fr">Français</option>
      <option value="es">Español</option>
      <option value="zh">中文</option>
    </select>
  </div>

  <!-- Navbar -->
  <nav class="gradient-bg px-6 py-3 shadow-xl">
    <div class="container mx-auto flex justify-between items-center">
      <div class="flex items-center space-x-4">
        <a href="#" class="text-2xl font-bold text-white">AetherSwap</a>
        <div class="hidden md:flex space-x-6">
          <a href="#swap" class="nav-link">Swap</a>
          <a href="#liquidity" class="nav-link">Liquidity</a>
          <a href="#farm" class="nav-link">Farm (APR: 325%)</a>
          <a href="#launchpad" class="nav-link">Launchpad</a>
        </div>
      </div>
      <button id="connectWalletBtn" class="connect-wallet-btn">
        <i class="fas fa-wallet mr-2"></i>
        <span id="walletText">Connect Wallet</span>
      </button>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Swap Card -->
    <div class="lg:col-span-2 space-y-6">
      <div class="bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-700">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold">Multi-DEX Aggregator</h2>
          <div class="flex space-x-2">
            <button class="px-3 py-1 bg-gray-700 rounded-lg text-sm">0.5% Slippage</button>
            <button class="px-3 py-1 bg-gray-700 rounded-lg text-sm">Auto Router</button>
          </div>
        </div>

        <!-- From Token -->
        <div class="bg-gray-750 rounded-xl p-4 mb-3">
          <div class="flex justify-between mb-2">
            <label class="text-gray-400">From</label>
            <div class="text-sm text-gray-400">
              <span id="fromBalanceText">Balance: 0.0</span>
              <button class="ml-2 text-purple-400">Max</button>
            </div>
          </div>
          <div class="flex items-center">
            <input 
              type="number" 
              id="fromAmount" 
              placeholder="0.0" 
              class="bg-transparent text-2xl w-full focus:outline-none"
            >
            <div class="flex items-center bg-gray-700 rounded-lg px-3 py-2">
              <img id="fromTokenImg" src="https://cryptologos.cc/logos/solana-sol-logo.png" class="w-6 h-6 mr-2">
              <select id="fromTokenSelect" class="bg-transparent focus:outline-none">
                <option value="SOL">SOL</option>
                <option value="USDC">USDC</option>
                <option value="BONK">BONK</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Switch Button -->
        <div class="flex justify-center my-2">
          <button id="switchTokensBtn" class="bg-gray-700 p-2 rounded-full hover:bg-gray-600 transition">
            <i class="fas fa-arrow-down text-purple-400"></i>
          </button>
        </div>

        <!-- To Token -->
        <div class="bg-gray-750 rounded-xl p-4 mb-4">
          <div class="flex justify-between mb-2">
            <label class="text-gray-400">To</label>
            <div class="text-sm text-gray-400">
              <span id="toBalanceText">Balance: 0.0</span>
            </div>
          </div>
          <div class="flex items-center">
            <input 
              type="number" 
              id="toAmount" 
              placeholder="0.0" 
              class="bg-transparent text-2xl w-full focus:outline-none" 
              disabled
            >
            <div class="flex items-center bg-gray-700 rounded-lg px-3 py-2">
              <img id="toTokenImg" src="https://cryptologos.cc/logos/usd-coin-usdc-logo.png" class="w-6 h-6 mr-2">
              <select id="toTokenSelect" class="bg-transparent focus:outline-none">
                <option value="USDC">USDC</option>
                <option value="SOL">SOL</option>
                <option value="BONK">BONK</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Price Info -->
        <div id="priceInfo" class="bg-gray-750 rounded-lg p-3 mb-4 text-center text-sm">
          <div class="animate-pulse">Fetching best price across 5 DEXs...</div>
        </div>

        <!-- Swap Button -->
        <button id="swapBtn" class="w-full gradient-bg py-3 rounded-xl font-bold text-white hover:opacity-90 transition disabled:opacity-50">
          Swap Now
        </button>
      </div>

      <!-- Advanced Chart -->
      <div class="bg-gray-800 rounded-2xl p-4 shadow-lg border border-gray-700">
        <div class="h-96" id="tradingview-chart"></div>
      </div>
    </div>

    <!-- Right Sidebar -->
    <div class="space-y-6">
      <!-- Best Routes -->
      <div class="bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-700">
        <h3 class="font-bold mb-4">Optimal Routes</h3>
        <div id="routesContainer" class="space-y-3">
          <div class="route-card">
            <div class="flex justify-between">
              <span>Jupiter</span>
              <span class="text-green-400">Best Price</span>
            </div>
            <div class="text-sm text-gray-400">SOL → USDC</div>
            <div class="flex justify-between mt-1">
              <span>1 SOL = 24.56 USDC</span>
              <span>0.15% fee</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Portfolio Summary -->
      <div class="bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-700">
        <h3 class="font-bold mb-4">Your Portfolio</h3>
        <div class="space-y-4">
          <div class="flex justify-between">
            <span>Total Value</span>
            <span class="font-mono">$1,245.32</span>
          </div>
          <div class="flex justify-between text-sm">
            <span class="text-gray-400">24h Change</span>
            <span class="text-green-400">+3.2%</span>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Language Translations -->
  <script>
    const translations = {
      en: {
        connectWallet: "Connect Wallet",
        from: "From",
        to: "To",
        balance: "Balance",
        max: "Max",
        swapNow: "Swap Now",
        fetchingPrice: "Fetching best price across 5 DEXs..."
      },
      fr: {
        connectWallet: "Connecter Portefeuille",
        from: "De",
        to: "À",
        balance: "Solde",
        max: "Max",
        swapNow: "Échanger Maintenant",
        fetchingPrice: "Recherche du meilleur prix sur 5 DEX..."
      },
      es: {
        connectWallet: "Conectar Billetera",
        from: "De",
        to: "A",
        balance: "Saldo",
        max: "Máx",
        swapNow: "Intercambiar Ahora",
        fetchingPrice: "Buscando mejor precio en 5 DEXs..."
      },
      zh: {
        connectWallet: "连接钱包",
        from: "从",
        to: "到",
        balance: "余额",
        max: "最大",
        swapNow: "立即交换",
        fetchingPrice: "正在5个DEX中寻找最佳价格..."
      }
    };

    // Language switcher functionality
    document.getElementById('languageSelector').addEventListener('change', function() {
      const lang = this.value;
      updateLanguage(lang);
    });

    function updateLanguage(lang) {
      const t = translations[lang];
      document.getElementById('walletText').textContent = t.connectWallet;
      document.querySelector('[for="fromAmount"]').textContent = t.from;
      document.querySelector('[for="toAmount"]').textContent = t.to;
      document.getElementById('fromBalanceText').textContent = `${t.balance}: 0.0`;
      document.getElementById('toBalanceText').textContent = `${t.balance}: 0.0`;
      document.querySelector('#fromBalanceText + button').textContent = t.max;
      document.getElementById('swapBtn').textContent = t.swapNow;
      document.getElementById('priceInfo').innerHTML = `<div class="animate-pulse">${t.fetchingPrice}</div>`;
    }
  </script>

  <!-- TradingView Chart Integration -->
  <script>
    new TradingView.widget({
      autosize: true,
      symbol: "BINANCE:BTCUSDT",
      interval: "15",
      timezone: "Etc/UTC",
      theme: "dark",
      style: "1",
      locale: "en",
      toolbar_bg: "#0a0a0a",
      enable_publishing: false,
      hide_side_toolbar: false,
      container_id: "tradingview-chart"
    });
  </script>

  <!-- Main DEX Logic -->
  <script>
    // Configuration
    const DEX_APIS = {
      jupiter: "https://quote-api.jup.ag/v6",
      orca: "https://api.orca.so",
      raydium: "https://api.raydium.io"
    };

    // Token data
    const TOKENS = {
      SOL: {
        mint: "So11111111111111111111111111111111111111112",
        decimals: 9,
        logo: "https://cryptologos.cc/logos/solana-sol-logo.png"
      },
      USDC: {
        mint: "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
        decimals: 6,
        logo: "https://cryptologos.cc/logos/usd-coin-usdc-logo.png"
      },
      BONK: {
        mint: "DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263",
        decimals: 5,
        logo: "https://arweave.net/hQiPZOsRZXGXBJd_82PhVdlM_hACsT_q6wqwf5cSY7I"
      }
    };

    // Wallet connection
    async function connectWallet() {
      if (window.solana && window.solana.isPhantom) {
        try {
          const response = await window.solana.connect();
          const publicKey = response.publicKey.toString();
          document.getElementById('walletText').textContent = 
            publicKey.slice(0, 4) + '...' + publicKey.slice(-4);
          checkBalances();
        } catch (err) {
          console.error("Wallet connection error:", err);
        }
      } else {
        window.open("https://phantom.app/", "_blank");
      }
    }

    document.getElementById('connectWalletBtn').addEventListener('click', connectWallet);

    // Multi-DEX price aggregation
    async function getBestQuote(fromToken, toToken, amount) {
      const requests = [
        axios.get(`${DEX_APIS.jupiter}/quote`, {
          params: {
            inputMint: TOKENS[fromToken].mint,
            outputMint: TOKENS[toToken].mint,
            amount: amount * Math.pow(10, TOKENS[fromToken].decimals),
            slippageBps: 50
          }
        }),
        // Add other DEX API calls here
      ];

      try {
        const responses = await Promise.all(requests);
        // Process responses to find best price
        return findOptimalRoute(responses);
      } catch (error) {
        console.error("Quote error:", error);
        return null;
      }
    }

    // Swap execution
    async function executeSwap() {
      // Implementation for cross-DEX swap
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Set up event listeners
      document.getElementById('fromAmount').addEventListener('input', async function() {
        const fromToken = document.getElementById('fromTokenSelect').value;
        const toToken = document.getElementById('toTokenSelect').value;
        const amount = parseFloat(this.value);
        
        if (amount > 0) {
          const quote = await getBestQuote(fromToken, toToken, amount);
          updatePriceInfo(quote);
        }
      });
    });
  </script>
</body>
</html>