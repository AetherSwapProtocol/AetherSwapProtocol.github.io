<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AetherSwap</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@solana/web3.js@latest"></script>
  <script src="https://unpkg.com/@solana/spl-token-registry@0.2.10/dist/index.iife.js"></script>
  <style>
    .lang-select{position:fixed;top:1rem;right:1rem;opacity:.7;transition:.2s}.lang-select:hover{opacity:1}
    .lang-select select{background:rgba(30,41,59,.7);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.1)}
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
  <div class="lang-select">
    <select id="language" class="px-3 py-1 rounded-lg text-sm focus:outline-none">
      <option value="en">🇬🇧 English</option>
      <option value="fr">🇫🇷 Français</option>
      <option value="es">🇪🇸 Español</option>
    </select>
  </div>
  <div class="container mx-auto max-w-md pt-20 p-4">
    <button id="connectWallet" class="mb-6 px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-sm">🔐 Connect Wallet</button>
    <h1 class="text-3xl font-bold text-center mb-4">AetherSwap</h1>
    <input id="search" type="text" placeholder="Search token..." class="w-full p-2 mb-4 bg-gray-700 rounded"/>
    <div id="tokenList" class="space-y-2 max-h-96 overflow-y-auto"></div>
  </div>
  <script>
    const langMap = {
      en: {search:"Search token...", connect:"🔐 Connect Wallet"},
      fr: {search:"Rechercher un token...", connect:"🔐 Connecter le portefeuille"},
      es: {search:"Buscar token...", connect:"🔐 Conectar billetera"}
    };

    const langSel = document.getElementById('language');
    langSel.addEventListener('change', () => setLang(langSel.value));
    function setLang(l){const t=langMap[l]||langMap.en;document.getElementById("search").placeholder=t.search;document.getElementById("connectWallet").innerText=t.connect;}
    setLang('en');

    document.getElementById("connectWallet").onclick = async () => {
      if (window.solana && window.solana.isPhantom) {
        try {
          const res = await window.solana.connect();
          alert("Connected: " + res.publicKey.toString());
        } catch (err) { alert("Connection rejected."); }
      } else alert("Phantom/Backpack not found.");
    };

    async function loadTokens(){
      const provider = new splTokenRegistry.TokenListProvider();
      const tokenList = await provider.resolve().then(tl => tl.filterByChainId(101).getList());
      window.allTokens = tokenList;
      displayTokens(tokenList);
    }

    function displayTokens(tokens){
      const list = document.getElementById("tokenList");
      list.innerHTML = tokens.map(t=>`
        <div class="flex items-center p-2 bg-gray-800 rounded hover:bg-gray-700 cursor-pointer">
          <img src="${t.logoURI}" alt="${t.symbol}" class="w-6 h-6 mr-3 rounded-full"/>
          <div><div class="font-semibold">${t.symbol}</div><div class="text-xs text-gray-400">${t.name}</div></div>
        </div>`).join("");
    }

    document.getElementById("search").oninput = e => {
      const q = e.target.value.toLowerCase();
      displayTokens(window.allTokens.filter(t => t.symbol.toLowerCase().includes(q) || t.name.toLowerCase().includes(q)));
    };

    loadTokens();
  </script>
</body>
</html>
