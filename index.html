<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AetherSwap - Crypto Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
    :root {
      --primary: #00e6ff;
      --primary-dark: #00b8cc;
      --bg-gradient: linear-gradient(135deg, #0a1f2e, #144d6e, #0a1f2e);
      --card-bg: rgba(255, 255, 255, 0.05);
      --text-light: #e0f7fa;
      --text-dark: #00474f;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg-gradient);
      color: var(--text-light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    /* Header avec connexion wallet */
    header {
      background: rgba(0, 230, 255, 0.15);
      backdrop-filter: blur(10px);
      padding: 15px 30px;
      box-shadow: 0 4px 15px rgba(0, 230, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 15px;
      position: relative;
      z-index: 100;
    }
    
    .logo-container {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    header img {
      width: 40px;
      height: 40px;
      transition: transform 0.3s ease;
    }
    
    header img:hover {
      transform: rotate(15deg);
    }
    
    header h1 {
      margin: 0;
      font-weight: 600;
      font-size: 1.8rem;
      color: var(--primary);
      text-shadow: 0 0 10px var(--primary);
    }
    
    #wallet-btn {
      background: var(--primary);
      color: var(--text-dark);
      border: none;
      border-radius: 12px;
      padding: 10px 20px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 4px 15px var(--primary);
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    
    #wallet-btn:hover {
      background: var(--primary-dark);
      box-shadow: 0 6px 20px var(--primary-dark);
    }
    
    #wallet-btn.connected {
      background: #10b981;
      box-shadow: 0 4px 15px #10b98188;
    }
    
    #wallet-btn.connected:hover {
      background: #0e9f6e;
    }
    
    /* Contenu principal */
    main {
      flex-grow: 1;
      max-width: 1200px;
      margin: 30px auto 40px;
      padding: 0 20px;
      width: 100%;
      animation: fadeIn 0.5s ease-out;
    }
    
    h2 {
      color: var(--primary);
      margin-bottom: 20px;
      text-align: center;
      text-shadow: 0 0 8px var(--primary);
      font-size: 1.8rem;
    }
    
    .widget-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }
    
    .widget {
      background: var(--card-bg);
      border-radius: 15px;
      box-shadow: 0 6px 20px rgba(0, 230, 255, 0.2);
      padding: 20px 25px;
      backdrop-filter: blur(15px);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      min-height: 200px;
    }
    
    .widget:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 230, 255, 0.3);
    }
    
    .widget-lg {
      grid-column: span 2;
    }
    
    /* Liste des tokens */
    ul.token-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    ul.token-list li {
      display: flex;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(0, 230, 255, 0.15);
      font-weight: 600;
      font-size: 1.05rem;
      gap: 15px;
      transition: background 0.2s ease;
    }
    
    ul.token-list li:hover {
      background: rgba(0, 230, 255, 0.1);
    }
    
    ul.token-list li img {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      box-shadow: 0 0 8px #00e6ffaa;
    }
    
    /* Contr√¥les de recherche */
    .search-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      margin: 15px 0 25px;
    }
    
    select, input, button {
      font-family: 'Poppins', sans-serif;
      font-size: 16px;
      padding: 12px 18px;
      border-radius: 12px;
      border: none;
      outline: none;
      transition: all 0.3s ease;
      min-width: 240px;
      max-width: 100%;
    }
    
    select {
      background: rgba(0, 230, 255, 0.15);
      color: var(--primary);
      font-weight: 600;
      box-shadow: inset 0 0 8px #00e6ff88;
    }
    
    input {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-light);
    }
    
    input:focus {
      box-shadow: 0 0 0 2px var(--primary);
    }
    
    button {
      background: var(--primary);
      color: var(--text-dark);
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 4px 15px var(--primary);
      user-select: none;
    }
    
    button:hover {
      background: var(--primary-dark);
      box-shadow: 0 6px 20px var(--primary-dark);
    }
    
    button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }
    
    /* R√©sultats et graphique */
    .result-token {
      margin-top: 25px;
      background: var(--card-bg);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 6px 20px rgba(0, 230, 255, 0.25);
      font-size: 1.1rem;
      text-align: center;
      font-weight: 600;
      color: var(--primary);
      animation: fadeIn 0.5s ease-out;
    }
    
    .chart-container {
      position: relative;
      height: 300px;
      width: 100%;
      margin-top: 20px;
    }
    
    /* Simulateur d'√©change */
    .swap-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .swap-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .swap-row input {
      flex-grow: 1;
    }
    
    .swap-row select {
      min-width: 120px;
    }
    
    .swap-rate {
      text-align: center;
      margin: 10px 0;
      font-size: 0.9rem;
      color: var(--primary);
    }
    
    /* Footer */
    footer {
      text-align: center;
      padding: 20px 10px;
      background: rgba(0, 230, 255, 0.1);
      color: #007a8a;
      font-weight: 600;
      user-select: none;
      box-shadow: inset 0 1px 4px #00e6ff33;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .pulse {
      animation: pulse 2s infinite;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      header {
        padding: 15px;
      }
      
      .widget-lg {
        grid-column: span 1;
      }
      
      .search-controls {
        flex-direction: column;
      }
      
      select, input, button {
        width: 100%;
      }
    }
    
    @media (max-width: 480px) {
      header h1 {
        font-size: 1.5rem;
      }
      
      .logo-container img {
        width: 32px;
        height: 32px;
      }
      
      #wallet-btn {
        padding: 8px 15px;
        font-size: 0.9rem;
      }
      
      h2 {
        font-size: 1.5rem;
      }
      
      .widget {
        padding: 15px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-container">
      <img src="https://img.icons8.com/fluency/48/00e6ff/circle-circled.png" alt="AetherSwap Logo" />
      <h1>AetherSwap</h1>
    </div>
    <button id="wallet-btn">
      <i class="fas fa-wallet"></i>
      <span>Connect Wallet</span>
    </button>
  </header>

  <main>
    <section class="widget widget-lg">
      <h2>üìä Token Price Chart</h2>
      <div class="chart-container">
        <canvas id="priceChart"></canvas>
      </div>
    </section>
    
    <div class="widget-grid">
      <section class="widget">
        <h2>üî• Top 10 Tokens</h2>
        <ul id="top10" class="token-list">Loading...</ul>
      </section>

      <section class="widget">
        <h2>üí± Swap Simulator</h2>
        <div class="swap-container">
          <div class="swap-row">
            <input type="number" id="swap-from-amount" placeholder="0.0" value="1" min="0" step="0.01" />
            <select id="swap-from-token">
              <option value="bitcoin">BTC</option>
              <option value="ethereum">ETH</option>
              <option value="tether">USDT</option>
              <option value="binancecoin">BNB</option>
            </select>
          </div>
          
          <div class="swap-row" style="justify-content: center;">
            <button onclick="swapTokens()" style="border-radius: 50%; width: 40px; height: 40px; padding: 0;">
              <i class="fas fa-exchange-alt"></i>
            </button>
          </div>
          
          <div class="swap-row">
            <input type="number" id="swap-to-amount" placeholder="0.0" readonly />
            <select id="swap-to-token">
              <option value="ethereum">ETH</option>
              <option value="bitcoin">BTC</option>
              <option value="tether">USDT</option>
              <option value="binancecoin">BNB</option>
            </select>
          </div>
          
          <div class="swap-rate" id="swap-rate">
            1 BTC = Loading...
          </div>
          
          <button onclick="executeSwap()" id="swap-btn" disabled>
            <i class="fas fa-exchange-alt"></i> Swap
          </button>
        </div>
      </section>
    </div>

    <section class="widget">
      <h2>üîç Search by Contract Address</h2>
      <div class="search-controls">
        <select id="blockchain">
          <option value="ethereum">Ethereum</option>
          <option value="binance-smart-chain">BNB Smart Chain</option>
          <option value="polygon-pos">Polygon</option>
          <option value="avalanche">Avalanche</option>
          <option value="arbitrum-one">Arbitrum</option>
          <option value="optimistic-ethereum">Optimism</option>
          <option value="solana">Solana (SPL Mint)</option>
        </select>
        <input type="text" id="contract" placeholder="Contract address or SPL Mint" />
        <button onclick="searchByContract()">Search</button>
      </div>
      <div id="result" class="result-token"></div>
    </section>
  </main>

  <footer>
    ¬© 2025 AetherSwap ‚Äî The future of DEX is here üöÄ
  </footer>

  <script>
    // Variables globales
    let priceChart;
    let walletAddress = null;
    let tokenPrices = {};
    
    // Initialisation
    document.addEventListener('DOMContentLoaded', async () => {
      loadTop10();
      initSwapSimulator();
      initWallet();
      loadChartData('bitcoin');
    });
    
    // 1. Syst√®me de connexion wallet
    function initWallet() {
      const walletBtn = document.getElementById('wallet-btn');
      
      walletBtn.addEventListener('click', async () => {
        if (walletAddress) {
          // D√©connexion
          walletAddress = null;
          walletBtn.innerHTML = '<i class="fas fa-wallet"></i><span>Connect Wallet</span>';
          walletBtn.classList.remove('connected');
          return;
        }
        
        try {
          // Simulation de connexion (remplacer par web3 ou phantom dans un vrai projet)
          walletBtn.disabled = true;
          walletBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>Connecting...</span>';
          
          // Simuler un d√©lai de connexion
          await new Promise(resolve => setTimeout(resolve, 1500));
          
          // G√©n√©rer une adresse al√©atoire pour la d√©mo
          walletAddress = '0x' + Math.random().toString(16).substr(2, 40);
          const shortAddress = walletAddress.substr(0, 6) + '...' + walletAddress.substr(-4);
          
          walletBtn.innerHTML = `<i class="fas fa-check-circle"></i><span>${shortAddress}</span>`;
          walletBtn.classList.add('connected');
          
          // Petite animation de succ√®s
          walletBtn.classList.add('pulse');
          setTimeout(() => walletBtn.classList.remove('pulse'), 2000);
        } catch (error) {
          console.error('Wallet error:', error);
          walletBtn.innerHTML = '<i class="fas fa-exclamation-triangle"></i><span>Error</span>';
          setTimeout(() => {
            walletBtn.innerHTML = '<i class="fas fa-wallet"></i><span>Connect Wallet</span>';
            walletBtn.disabled = false;
          }, 1500);
        } finally {
          walletBtn.disabled = false;
        }
      });
    }
    
    // 2. Graphique de prix
    async function loadChartData(tokenId) {
      try {
        const res = await fetch(`https://api.coingecko.com/api/v3/coins/${tokenId}/market_chart?vs_currency=usd&days=30`);
        if (!res.ok) throw new Error("Chart data error");
        const data = await res.json();
        
        const prices = data.prices.map(price => price[1]);
        const timestamps = data.prices.map(price => 
          new Date(price[0]).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })
        );
        
        if (priceChart) {
          priceChart.destroy();
        }
        
        const ctx = document.getElementById('priceChart').getContext('2d');
        priceChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: timestamps,
            datasets: [{
              label: `${tokenId.toUpperCase()} Price (USD)`,
              data: prices,
              borderColor: '#00e6ff',
              backgroundColor: 'rgba(0, 230, 255, 0.1)',
              borderWidth: 2,
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                mode: 'index',
                intersect: false,
                callbacks: {
                  label: function(context) {
                    return `${context.dataset.label}: $${context.raw.toFixed(2)}`;
                  }
                }
              }
            },
            scales: {
              x: {
                grid: {
                  color: 'rgba(0, 230, 255, 0.1)'
                },
                ticks: {
                  color: '#00e6ff'
                }
              },
              y: {
                grid: {
                  color: 'rgba(0, 230, 255, 0.1)'
                },
                ticks: {
                  color: '#00e6ff',
                  callback: function(value) {
                    return '$' + value;
                  }
                }
              }
            }
          }
        });
      } catch (error) {
        console.error('Chart error:', error);
      }
    }
    
    // 3. Simulateur d'√©change
    async function initSwapSimulator() {
      // Charger les prix initiaux
      await updateTokenPrices();
      
      // Configurer les √©couteurs d'√©v√©nements
      document.getElementById('swap-from-amount').addEventListener('input', calculateSwap);
      document.getElementById('swap-from-token').addEventListener('change', async () => {
        await updateTokenPrices();
        calculateSwap();
      });
      document.getElementById('swap-to-token').addEventListener('change', async () => {
        await updateTokenPrices();
        calculateSwap();
      });
      
      // Calcul initial
      calculateSwap();
    }
    
    async function updateTokenPrices() {
      const fromToken = document.getElementById('swap-from-token').value;
      const toToken = document.getElementById('swap-to-token').value;
      
      try {
        const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${fromToken},${toToken}&vs_currencies=usd`);
        if (!res.ok) throw new Error("Price fetch error");
        const data = await res.json();
        
        tokenPrices[fromToken] = data[fromToken].usd;
        tokenPrices[toToken] = data[toToken].usd;
        
        // Mettre √† jour le taux
        const rate = (tokenPrices[fromToken] / tokenPrices[toToken]).toFixed(6);
        document.getElementById('swap-rate').textContent = 
          `1 ${fromToken.toUpperCase()} = ${rate} ${toToken.toUpperCase()}`;
          
        return true;
      } catch (error) {
        console.error('Price update error:', error);
        document.getElementById('swap-rate').textContent = 'Error loading rates';
        return false;
      }
    }
    
    function calculateSwap() {
      const fromAmount = parseFloat(document.getElementById('swap-from-amount').value) || 0;
      const fromToken = document.getElementById('swap-from-token').value;
      const toToken = document.getElementById('swap-to-token').value;
      
      if (tokenPrices[fromToken] && tokenPrices[toToken]) {
        const result = (fromAmount * tokenPrices[fromToken]) / tokenPrices[toToken];
        document.getElementById('swap-to-amount').value = result.toFixed(6);
        document.getElementById('swap-btn').disabled = fromAmount <= 0;
      }
    }
    
    function swapTokens() {
      const fromToken = document.getElementById('swap-from-token');
      const toToken = document.getElementById('swap-to-token');
      
      const temp = fromToken.value;
      fromToken.value = toToken.value;
      toToken.value = temp;
      
      updateTokenPrices().then(() => calculateSwap());
    }
    
    function executeSwap() {
      if (!walletAddress) {
        alert('Please connect your wallet first');
        return;
      }
      
      const fromAmount = document.getElementById('swap-from-amount').value;
      const fromToken = document.getElementById('swap-from-token').value;
      const toToken = document.getElementById('swap-to-token').value;
      const toAmount = document.getElementById('swap-to-amount').value;
      
      const swapBtn = document.getElementById('swap-btn');
      swapBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Swapping...';
      swapBtn.disabled = true;
      
      // Simuler un √©change
      setTimeout(() => {
        swapBtn.innerHTML = '<i class="fas fa-check"></i> Swap Complete!';
        
        // Afficher une confirmation
        alert(`Successfully swapped ${fromAmount} ${fromToken.toUpperCase()} to ${toAmount} ${toToken.toUpperCase()}`);
        
        // R√©initialiser apr√®s 2 secondes
        setTimeout(() => {
          swapBtn.innerHTML = '<i class="fas fa-exchange-alt"></i> Swap';
          swapBtn.disabled = false;
        }, 2000);
      }, 2000);
    }
    
    // 4. Fonctions existantes (l√©g√®rement modifi√©es)
    async function loadTop10() {
      try {
        const res = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1');
        if (!res.ok) throw new Error("CoinGecko API error");
        const data = await res.json();
        const ul = document.getElementById('top10');
        ul.innerHTML = '';
        
        data.forEach(token => {
          const li = document.createElement('li');
          li.innerHTML = `
            <img src="${token.image}" alt="${token.name}" />
            ${token.name} (${token.symbol.toUpperCase()}) ‚Äî üíµ $ ${token.current_price.toLocaleString()}
          `;
          
          // Ajouter un clic pour charger le graphique
          li.style.cursor = 'pointer';
          li.addEventListener('click', () => {
            loadChartData(token.id);
            document.querySelector('main').scrollIntoView({ behavior: 'smooth' });
          });
          
          ul.appendChild(li);
        });
      } catch(e) {
        document.getElementById('top10').innerHTML = '<li>Unable to load data.</li>';
      }
    }
    
    async function searchByContract() {
      const contract = document.getElementById('contract').value.trim();
      const chain = document.getElementById('blockchain').value;
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
    
      if (!contract) {
        alert('Please enter a valid address or mint');
        resultDiv.innerHTML = '';
        return;
      }
    
      if (chain === 'solana') {
        try {
          const res = await fetch(`https://price.jup.ag/v4/price?ids=${contract}`);
          if (!res.ok) throw new Error("Token not found");
          const data = await res.json();
          const token = data.data[contract];
          if (!token) throw new Error("Token not found");
          
          resultDiv.innerHTML = `
            <p><strong>SPL Token (Solana)</strong></p>
            <p>Mint: ${contract}</p>
            <p>Price: $${token.price.toFixed(6)}</p>
            <button onclick="addToSwap('${contract}', 'solana')" style="margin-top: 10px;">
              <i class="fas fa-exchange-alt"></i> Add to Swap
            </button>
          `;
        } catch {
          resultDiv.innerHTML = '<p>Token not found on Solana (check the Mint address).</p>';
        }
      } else {
        try {
          const res = await fetch(`https://api.coingecko.com/api/v3/coins/${chain}/contract/${contract}`);
          if (!res.ok) throw new Error("Token not found");
          const token = await res.json();
          
          resultDiv.innerHTML = `
            <p><strong>${token.name}</strong> (${token.symbol.toUpperCase()})</p>
            <p>Current Price: $${token.market_data.current_price.usd}</p>
            <img src="${token.image.small}" alt="${token.name}" style="margin: 10px 0;" />
            <button onclick="addToSwap('${token.id}', '${chain}')" style="margin-top: 10px;">
              <i class="fas fa-exchange-alt"></i> Add to Swap
            </button>
          `;
          
          // Option pour voir le graphique
          resultDiv.innerHTML += `
            <button onclick="loadChartData('${token.id}')" style="margin-top: 5px; background: rgba(0, 230, 255, 0.2);">
              <i class="fas fa-chart-line"></i> View Chart
            </button>
          `;
        } catch {
          resultDiv.innerHTML = '<p>Token not found on CoinGecko.</p>';
        }
      }
    }
    
    function addToSwap(tokenId, chain) {
      alert(`Would add ${tokenId} (${chain}) to swap interface\n(Implementation depends on your DEX integration)`);
      // Dans une vraie impl√©mentation, vous ajouteriez le token aux s√©lecteurs d'√©change
    }
  </script>
</body>
</html>