<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AetherSwap LaunchLab</title>
  <meta name="description" content="Create and mint your token on Solana or EVM chains instantly." />

  <!-- Fonts & Tailwind -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" as="style">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Solana & Phantom SDK -->
  <script src="https://unpkg.com/@solana/web3.js@1.70.1/lib/index.iife.min.js" defer></script>

  <!-- EVM multi-chain via Web3Modal v2 -->
  <script src="https://unpkg.com/@web3modal/core@2.2.1/dist/index.umd.js" defer></script>
  <script src="https://unpkg.com/@web3modal/ethereum@1.0.30/dist/index.umd.js" defer></script>
  <script src="https://unpkg.com/@walletconnect/ethereum-provider@2.6.5/dist/ethereum-provider.umd.min.js" defer></script>
  <script src="https://cdn.ethers.io/lib/ethers-5.6.umd.min.js" defer></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* same gradient, modal, loader, ticker, etc. */
    :root { /* ... */ }
    /* styles omitted for brevity, identical to previous design */
  </style>
</head>
<body>
  <!-- Navbar, Ticker, Form, Wallet Modal same as above, all in English labels -->

  <script>
  document.addEventListener('DOMContentLoaded', async () => {
    // ------ Wallet Connection Modules ------

    // Phantom (Solana)
    phantomBtn.onclick = async () => {
      if (window.solana?.isPhantom) {
        const res = await window.solana.connect();
        const pk = res.publicKey.toString();
        connectBtn.textContent = `Phantom: ${pk.slice(0,4)}…${pk.slice(-4)}`;
      }
      toggleModal();
    };

    // EVM via Web3Modal
    evmBtn.onclick = async () => {
      const { Web3ModalCore } = window.W3MCore;
      const { EthereumClient } = window.W3MEthereum;
      const projectId = 'YOUR_PROJECT_ID'; // required
      const chains = [{ id: 1, name: 'Ethereum' }, { id: 137, name: 'Polygon' }];
      const w3m = Web3ModalCore({ projectId, theme: 'dark' });
      const ethClient = new EthereumClient({ projectId, chains }, w3m);
      const provider = await w3m.openModal({ modalConnectors: ethClient.connector });
      const ethersProvider = new ethers.providers.Web3Provider(provider);
      const signer = ethersProvider.getSigner();
      const addr = await signer.getAddress();
      const chain = await provider.request({ method: 'eth_chainId' });
      connectBtn.textContent = `EVM: ${addr.slice(0,6)}… (${parseInt(chain,16)})`;
      toggleModal();

      // EVM mint function
      window.evmSigner = signer;
    };

    // ------ Minting Logic ------

    form.onsubmit = async (e) => {
      e.preventDefault();
      const name = form.tokenName.value.trim(), symbol = form.tokenSymbol.value.trim();
      const supply = form.tokenSupply.value, decimals = form.tokenDecimals.value;

      if (connectBtn.textContent.startsWith('Phantom')) {
        // SOLANA: create mint using @solana/web3.js & spl-token
        const connection = new solanaWeb3.Connection('https://api.mainnet-beta.solana.com');
        const mintAccount = solanaWeb3.Keypair.generate();
        const lamports = await connection.getMinimumBalanceForRentExemption(82);
        let tx = new solanaWeb3.Transaction();
        tx.add(
          solanaWeb3.SystemProgram.createAccount({ 
            fromPubkey: window.solana.publicKey, 
            newAccountPubkey: mintAccount.publicKey, 
            space: 82, lamports, programId: solanaWeb3.TOKEN_PROGRAM_ID
          }),
          solanaWeb3.Token.createInitMintInstruction(
            solanaWeb3.TOKEN_PROGRAM_ID,
            mintAccount.publicKey, Number(decimals),
            window.solana.publicKey, window.solana.publicKey
          )
        );
        const sig = await window.solana.signAndSendTransaction(tx);
        alert(`Solana mint created: ${sig.signature}`);
      } else if (connectBtn.textContent.startsWith('EVM')) {
        // EVM: create ERC20 using ethers
        const abi = [
          "function name() view returns (string)", "function symbol() view returns (string)",
          "function decimals() view returns (uint8)", "function totalSupply() view returns (uint256)",
          "function mint(address to, uint256 amount)"
        ];
        const bytecode = "0x..."; // precompiled ERC20 bytecode
        const factory = new ethers.ContractFactory(abi, bytecode, window.evmSigner);
        const contract = await factory.deploy(name, symbol, decimals, supply);
        await contract.deployed();
        alert(`EVM ERC20 deployed at ${contract.address}`);
      } else {
        alert('Please connect a wallet first.');
      }
    };

    // ------ Ticker Logic (same as before) ------
  });
  </script>
</body>
</html>